<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>WKWebView的常用属性以及常用API | 小大</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">WKWebView的常用属性以及常用API</h1><a id="logo" href="/.">小大</a><p class="description">群居守口，独处守心</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">WKWebView的常用属性以及常用API</h1><div class="post-meta">Sep 19, 2018<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span></div><div class="post-content"><p>从WKWebView的推出到现在，相信大家很已经了解了它相对于UIWebView的优势，加载速度快，占用内存低同时也解决了内存泄漏的问题，所以现在绝大多数的项目都已经使用了WKWebView来替代UIWebView，本文主要是对WKWebView的一些常用属性一集常用API来讲解。</p>
<h2 id="1-WKWebView"><a href="#1-WKWebView" class="headerlink" title="1. WKWebView"></a>1. WKWebView</h2><h3 id="1-1-WKWebView主要涉及的类："><a href="#1-1-WKWebView主要涉及的类：" class="headerlink" title="1.1 WKWebView主要涉及的类："></a>1.1 WKWebView主要涉及的类：</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">WKWebView</span>                  <span class="comment">//网页的渲染与展示</span></span><br><span class="line"><span class="built_in">WKWebViewConfiguration</span>     <span class="comment">//这个类用于网页的配置</span></span><br><span class="line"><span class="built_in">WKUserScript</span>               <span class="comment">//用于往加载的页面中添加额外需要执行的JavaScript代码</span></span><br><span class="line"><span class="built_in">WKUserContentController</span>    <span class="comment">//用户原生与JavaScript交互</span></span><br><span class="line"><span class="built_in">WKWebsiteDataStore</span>         <span class="comment">//这个类在处理缓存的时候用到</span></span><br></pre></td></tr></table></figure>
<h3 id="1-2-WKWebView主要涉及的代理"><a href="#1-2-WKWebView主要涉及的代理" class="headerlink" title="1.2 WKWebView主要涉及的代理"></a>1.2 WKWebView主要涉及的代理</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">WKNavigationDelegate</span>        <span class="comment">//网页跳转间的导航管理协议，这个协议可以监听网页的活动</span></span><br><span class="line"><span class="built_in">WKUIDelegate</span>                <span class="comment">//用于交互处理JavaScript中的一些弹出框</span></span><br></pre></td></tr></table></figure>
<h3 id="1-3-WKWebView的一些常用属性"><a href="#1-3-WKWebView的一些常用属性" class="headerlink" title="1.3 WKWebView的一些常用属性"></a>1.3 WKWebView的一些常用属性</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导航代理</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;<span class="built_in">WKNavigationDelegate</span>&gt; navigationDelegate;</span><br><span class="line"><span class="comment">// UI代理</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;<span class="built_in">WKUIDelegate</span>&gt; <span class="built_in">UIDelegate</span>;</span><br><span class="line"><span class="comment">// 页面标题, 一般使用KVO动态获取</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *title;</span><br><span class="line"><span class="comment">// 页面加载进度, 一般使用KVO动态获取</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="keyword">double</span> estimatedProgress;</span><br><span class="line"><span class="comment">// 可返回的页面列表, 已打开过的网页, 有点类似于navigationController的viewControllers属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">strong</span>) <span class="built_in">WKBackForwardList</span> *backForwardList;</span><br><span class="line"><span class="comment">// 页面url</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSURL</span> *URL;</span><br><span class="line"><span class="comment">// 页面是否在加载中</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">getter</span>=isLoading) <span class="built_in">BOOL</span> loading;</span><br><span class="line"><span class="comment">// 是否可返回</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canGoBack;</span><br><span class="line"><span class="comment">// 是否可向前</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> canGoForward;</span><br><span class="line"><span class="comment">// WKWebView继承自UIView, 所以如果想设置scrollView的一些属性, 需要对此属性进行配置</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">strong</span>) <span class="built_in">UIScrollView</span> *scrollView;</span><br><span class="line"><span class="comment">// 是否允许手势左滑返回上一级, 类似导航控制的左滑返回</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> allowsBackForwardNavigationGestures;</span><br><span class="line"><span class="comment">//自定义UserAgent, 会覆盖默认的值 ,iOS 9之后有效</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *customUserAgent</span><br></pre></td></tr></table></figure>
<h3 id="1-4-WKWebView的一些常用方法"><a href="#1-4-WKWebView的一些常用方法" class="headerlink" title="1.4 WKWebView的一些常用方法"></a>1.4 WKWebView的一些常用方法</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 带配置信息的初始化方法,configuration 配置信息</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithFrame:(<span class="built_in">CGRect</span>)frame configuration:(<span class="built_in">WKWebViewConfiguration</span> *)configuration</span><br><span class="line"><span class="comment">// 加载请求</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)loadRequest:(<span class="built_in">NSURLRequest</span> *)request;</span><br><span class="line"><span class="comment">// 加载HTML</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)loadHTMLString:(<span class="built_in">NSString</span> *)string baseURL:(<span class="keyword">nullable</span> <span class="built_in">NSURL</span> *)baseURL;</span><br><span class="line"><span class="comment">// 返回上一级</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)goBack;</span><br><span class="line"><span class="comment">// 前进下一级, 需要曾经打开过, 才能前进</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)goForward;</span><br><span class="line"><span class="comment">// 刷新页面</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)reload;</span><br><span class="line"><span class="comment">// 根据缓存有效期来刷新页面</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">WKNavigation</span> *)reloadFromOrigin;</span><br><span class="line"><span class="comment">// 停止加载页面</span></span><br><span class="line">- (<span class="keyword">void</span>)stopLoading;</span><br><span class="line"><span class="comment">// 执行JavaScript代码</span></span><br><span class="line">- (<span class="keyword">void</span>)evaluateJavaScript:(<span class="built_in">NSString</span> *)javaScriptString completionHandler:(<span class="keyword">void</span> (^ _Nullable)(_Nullable <span class="keyword">id</span>, <span class="built_in">NSError</span> * _Nullable error))completionHandler;</span><br></pre></td></tr></table></figure>
<h3 id="2-WKWebViewConfiguration的常用属性"><a href="#2-WKWebViewConfiguration的常用属性" class="headerlink" title="2. WKWebViewConfiguration的常用属性"></a>2. WKWebViewConfiguration的常用属性</h3><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过此属性来执行JavaScript代码来修改页面的行为</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, strong) WKUserContentController *userContentController;</span><br><span class="line"></span><br><span class="line"><span class="comment">//***********下面属性一般不需要设置</span></span><br><span class="line"><span class="comment">// 首选项设置,  </span></span><br><span class="line"><span class="comment">//可设置最小字号, 是否允许执行js</span></span><br><span class="line"><span class="comment">//是否通过js自动打开新的窗口</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic, strong) WKPreferences *preferences;</span><br><span class="line"><span class="comment">// 是否允许播放媒体文件</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic) BOOL allowsAirPlayForMediaPlayback</span><br><span class="line"><span class="comment">// 需要用户来操作才能播放的多媒体类型</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic) WKAudiovisualMediaTypes mediaTypesRequiringUserActionForPlayback</span><br><span class="line"><span class="comment">// 是使用h5的视频播放器在线播放, 还是使用原生播放器全屏播放</span></span><br><span class="line"><span class="variable">@property</span> (nonatomic) BOOL allowsInlineMediaPlayback;</span><br></pre></td></tr></table></figure>
<h3 id="3-WKUserScript"><a href="#3-WKUserScript" class="headerlink" title="3.WKUserScript"></a>3.WKUserScript</h3><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"><span class="title">js</span>与原生交互主要依靠的类</span><br><span class="line"></span><br><span class="line"><span class="title">source</span>: 需要执行的<span class="type">JavaScript</span>代码</span><br><span class="line"><span class="title">injectionTime</span>: 加入的位置, 是一个枚举</span><br><span class="line">typedef <span class="type">NS_ENUM</span>(<span class="type">NSInteger</span>, <span class="type">WKUserScriptInjectionTime</span>) &#123;</span><br><span class="line">    <span class="type">WKUserScriptInjectionTimeAtDocumentStart</span>,</span><br><span class="line">    <span class="type">WKUserScriptInjectionTimeAtDocumentEnd</span></span><br><span class="line">&#125; <span class="type">API_AVAILABLE</span>(macosx(10.10), ios(8.0));</span><br><span class="line"></span><br><span class="line"><span class="title">forMainFrameOnly</span>: 是加入所有框架, 还是只加入主框架</span><br><span class="line">*/</span><br><span class="line">- (instance<span class="keyword">type</span>)initWithSource:(<span class="type">NSString</span> *)source injectionTime:(<span class="type">WKUserScriptInjectionTime</span>)injectionTime forMainFrameOnly:(<span class="type">BOOL</span>)forMainFrameOnly;</span><br></pre></td></tr></table></figure>
<h3 id="4-WKUserContentController"><a href="#4-WKUserContentController" class="headerlink" title="4.WKUserContentController"></a>4.WKUserContentController</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注入JavaScript与原生交互协议</span></span><br><span class="line"><span class="comment">// JS 端可通过 window.webkit.messageHandlers.&lt;name&gt;.postMessage(&lt;messageBody&gt;) 发送消息</span></span><br><span class="line">- (<span class="keyword">void</span>)addScriptMessageHandler:(<span class="keyword">id</span> &lt;<span class="built_in">WKScriptMessageHandler</span>&gt;)scriptMessageHandler name:(<span class="built_in">NSString</span> *)name;</span><br><span class="line"><span class="comment">// 移除注入的协议, 在deinit方法中调用</span></span><br><span class="line">- (<span class="keyword">void</span>)removeScriptMessageHandlerForName:(<span class="built_in">NSString</span> *)name;</span><br><span class="line"><span class="comment">// 通过WKUserScript注入需要执行的JavaScript代码</span></span><br><span class="line">- (<span class="keyword">void</span>)addUserScript:(<span class="built_in">WKUserScript</span> *)userScript;</span><br><span class="line"><span class="comment">// 移除所有注入的JavaScript代码</span></span><br><span class="line">- (<span class="keyword">void</span>)removeAllUserScripts;</span><br></pre></td></tr></table></figure>
<h4 id="WKScriptMessageHandler"><a href="#WKScriptMessageHandler" class="headerlink" title="WKScriptMessageHandler"></a>WKScriptMessageHandler</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)userContentController:(<span class="built_in">WKUserContentController</span> *)userContentController didReceiveScriptMessage:(<span class="built_in">WKScriptMessage</span> *)message;</span><br><span class="line"></span><br><span class="line"><span class="built_in">WKScriptMessage</span>类的主要属性</span><br><span class="line"><span class="comment">// 协议名称, 即上面的add方法传递的name</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="comment">// 传递的参数</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="keyword">id</span> body;</span><br></pre></td></tr></table></figure>
<h3 id="5-WKUIDelegate"><a href="#5-WKUIDelegate" class="headerlink" title="5.WKUIDelegate"></a>5.WKUIDelegate</h3><p>这个代理方法,主要是用来处理使用系统的弹框来替换JS中的一些弹框的,比如: 警告框, 选择框, 输入框。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> webView中弹出警告框时调用, 只能有一个按钮</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> webView webView</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> message 提示信息</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> frame 可用于区分哪个窗口调用的</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> completionHandler 警告框消失的时候调用, 回调给JS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">webView:</span>(WKWebView *)webView <span class="string">runJavaScriptAlertPanelWithMessage:</span>(NSString *)message <span class="string">initiatedByFrame:</span>(WKFrameInfo *)frame <span class="string">completionHandler:</span>(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 对应js的confirm方法</span></span><br><span class="line"><span class="comment"> webView中弹出选择框时调用, 两个按钮</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> webView webView description</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> message 提示信息</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> frame 可用于区分哪个窗口调用的</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> completionHandler 确认框消失的时候调用, 回调给JS, 参数为选择结果: YES or NO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">webView:</span>(WKWebView *)webView <span class="string">runJavaScriptConfirmPanelWithMessage:</span>(NSString *)message <span class="string">initiatedByFrame:</span>(WKFrameInfo *)frame <span class="string">completionHandler:</span>(<span class="keyword">void</span> (^)(BOOL result))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 对应js的prompt方法</span></span><br><span class="line"><span class="comment"> webView中弹出输入框时调用, 两个按钮 和 一个输入框</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> webView webView description</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> prompt 提示信息</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> defaultText 默认提示文本</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> frame 可用于区分哪个窗口调用的</span></span><br><span class="line"><span class="comment"> <span class="doctag">@param</span> completionHandler 输入框消失的时候调用, 回调给JS, 参数为输入的内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)<span class="string">webView:</span>(WKWebView *)webView <span class="string">runJavaScriptTextInputPanelWithPrompt:</span>(NSString *)prompt <span class="string">defaultText:</span>(nullable NSString *)defaultText <span class="string">initiatedByFrame:</span>(WKFrameInfo *)frame <span class="string">completionHandler:</span>(<span class="keyword">void</span> (^)(NSString * _Nullable result))completionHandler;</span><br></pre></td></tr></table></figure>
<h3 id="6-WKNavigationDelegate"><a href="#6-WKNavigationDelegate" class="headerlink" title="6.WKNavigationDelegate"></a>6.WKNavigationDelegate</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 决定导航的动作，通常用于处理跨域的链接能否导航。</span></span><br><span class="line"><span class="comment">// WebKit对跨域进行了安全检查限制，不允许跨域，因此我们要对不能跨域的链接单独处理。</span></span><br><span class="line"><span class="comment">// 但是，对于Safari是允许跨域的，不用这么处理。</span></span><br><span class="line"><span class="comment">// 这个是决定是否Request</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationAction:(<span class="built_in">WKNavigationAction</span> *)navigationAction decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationActionPolicy</span>))decisionHandler&#123;</span><br><span class="line">    <span class="comment">//  在发送请求之前，决定是否跳转</span></span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否接收响应</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationResponse:(<span class="built_in">WKNavigationResponse</span> *)navigationResponse decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationResponsePolicy</span>))decisionHandler&#123;</span><br><span class="line">    <span class="comment">// 在收到响应后，决定是否跳转和发送请求之前那个允许配套使用</span></span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationResponsePolicyAllow</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//用于授权验证的API，与AFN、UIWebView的授权验证API是一样的</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didReceiveAuthenticationChallenge:(<span class="built_in">NSURLAuthenticationChallenge</span> *)challenge completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionAuthChallengeDisposition</span> disposition, <span class="built_in">NSURLCredential</span> *__<span class="keyword">nullable</span> credential))completionHandler&#123;</span><br><span class="line">    </span><br><span class="line">    completionHandler(<span class="built_in">NSURLSessionAuthChallengePerformDefaultHandling</span> ,<span class="literal">nil</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// main frame的导航开始请求时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didStartProvisionalNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当main frame接收到服务重定向时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didReceiveServerRedirectForProvisionalNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation&#123;</span><br><span class="line">    <span class="comment">// 接收到服务器跳转请求之后调用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当main frame开始加载数据失败时，会回调</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didFailProvisionalNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation withError:(<span class="built_in">NSError</span> *)error &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当内容开始返回时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didCommitNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation&#123;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//当main frame导航完成时，会回调</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didFinishNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation&#123;</span><br><span class="line">    <span class="comment">// 页面加载完成之后调用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当main frame最后下载数据失败时，会回调</span></span><br><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView didFailNavigation:(<span class="keyword">null_unspecified</span> <span class="built_in">WKNavigation</span> *)navigation withError:(<span class="built_in">NSError</span> *)error &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当web content处理完成时，会回调</span></span><br><span class="line">- (<span class="keyword">void</span>)webViewWebContentProcessDidTerminate:(<span class="built_in">WKWebView</span> *)webView &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-WKWebsiteDataStore"><a href="#7-WKWebsiteDataStore" class="headerlink" title="7.WKWebsiteDataStore"></a>7.WKWebsiteDataStore</h3><p>WKWebsiteDataStore提供了网站所能使用的数据类型，包括 cookies，硬盘缓存，内存缓存活在一些WebSQL的数据持久化和本地持久化。可通过 WKWebViewConfiguration 类的属性 websiteDataStore 进行相关的设置。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 默认的data store</span></span><br><span class="line">+ (<span class="built_in">WKWebsiteDataStore</span> *)defaultDataStore;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果为webView设置了这个data Store，则不会有数据缓存被写入文件</span></span><br><span class="line"><span class="comment">// 当需要实现隐私浏览的时候，可使用这个</span></span><br><span class="line">+ (<span class="built_in">WKWebsiteDataStore</span> *)nonPersistentDataStore;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是否是可缓存数据的，只读</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">getter</span>=isPersistent) <span class="built_in">BOOL</span> persistent;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取所有可使用的数据类型</span></span><br><span class="line">+ (<span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *)allWebsiteDataTypes;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 查找指定类型的缓存数据</span></span><br><span class="line"><span class="comment">// 回调的值是WKWebsiteDataRecord的集合</span></span><br><span class="line">- (<span class="keyword">void</span>)fetchDataRecordsOfTypes:(<span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *)dataTypes completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span>&lt;<span class="built_in">WKWebsiteDataRecord</span> *&gt; *))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除指定的纪录</span></span><br><span class="line"><span class="comment">// 这里的参数是通过上面的方法查找到的WKWebsiteDataRecord实例获取的</span></span><br><span class="line">- (<span class="keyword">void</span>)removeDataOfTypes:(<span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *)dataTypes forDataRecords:(<span class="built_in">NSArray</span>&lt;<span class="built_in">WKWebsiteDataRecord</span> *&gt; *)dataRecords completionHandler:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除某时间后修改的某类型的数据</span></span><br><span class="line">- (<span class="keyword">void</span>)removeDataOfTypes:(<span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *)websiteDataTypes modifiedSince:(<span class="built_in">NSDate</span> *)date completionHandler:(<span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存的HTTP cookies</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">WKHTTPCookieStore</span> *httpCookieStore</span><br></pre></td></tr></table></figure>
<h4 id="datatypes"><a href="#datatypes" class="headerlink" title="datatypes"></a>datatypes</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 硬盘缓存</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeDiskCache</span>,</span><br><span class="line"><span class="comment">// HTML离线web应用程序缓存</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeOfflineWebApplicationCache</span>,</span><br><span class="line"><span class="comment">// 内存缓存</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeMemoryCache</span>,</span><br><span class="line"><span class="comment">// 本地缓存</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeLocalStorage</span>,</span><br><span class="line"><span class="comment">// cookies</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeCookies</span>,</span><br><span class="line"><span class="comment">// HTML会话存储</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeSessionStorage</span>,</span><br><span class="line"><span class="comment">//  IndexedDB 数据库</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeIndexedDBDatabases</span>,</span><br><span class="line"><span class="comment">// WebSQL 数据库</span></span><br><span class="line"><span class="built_in">WKWebsiteDataTypeWebSQLDatabases</span></span><br></pre></td></tr></table></figure>
<h4 id="WKWebsiteDataRecord"><a href="#WKWebsiteDataRecord" class="headerlink" title="WKWebsiteDataRecord"></a>WKWebsiteDataRecord</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 展示名称, 通常是域名</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *displayName;</span><br><span class="line"><span class="comment">// 包含的数据类型</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSSet</span>&lt;<span class="built_in">NSString</span> *&gt; *dataTypes;</span><br></pre></td></tr></table></figure>
<h4 id="WKHTTPCookieStore"><a href="#WKHTTPCookieStore" class="headerlink" title="WKHTTPCookieStore"></a>WKHTTPCookieStore</h4><p>关于cookie, 从WKWebsiteDataStore 的实例对象的数属性httpCookieStore 可获取一个 WKHTTPCookieStore 的实例对象, 通过此对象, 我们可以对cookie进行相关的操作, 官方提供的API也不难理解:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  查找所有已存储的cookie</span></span><br><span class="line">- (<span class="keyword">void</span>)getAllCookies:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSHTTPCookie</span> *&gt; *))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存一个cookie, 保存成功后, 会走一次回调方法</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setCookie:(<span class="built_in">NSHTTPCookie</span> *)cookie completionHandler:(<span class="keyword">nullable</span> <span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除一个cookie, 待删除的cookie对象可通过 'getAllCookies' 方法获取</span></span><br><span class="line">- (<span class="keyword">void</span>)deleteCookie:(<span class="built_in">NSHTTPCookie</span> *)cookie completionHandler:(<span class="keyword">nullable</span> <span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加一个观察者, 需要遵循协议 WKHTTPCookieStoreObserver,当cookie发送变化时, 会通过 WKHTTPCookieStoreObserver 的协议方法通知该观察者, 在使用完后需要移除观察者</span></span><br><span class="line"> */</span><br><span class="line">- (<span class="keyword">void</span>)addObserver:(<span class="keyword">id</span>&lt;<span class="built_in">WKHTTPCookieStoreObserver</span>&gt;)observer;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除观察者</span></span><br><span class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>&lt;<span class="built_in">WKHTTPCookieStoreObserver</span>&gt;)observer;</span><br></pre></td></tr></table></figure>
<h4 id="简单应用"><a href="#简单应用" class="headerlink" title="简单应用"></a>简单应用</h4><p>删除指定时间的所有类型数据</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSSet</span> *websiteDataTypes = [<span class="built_in">WKWebsiteDataStore</span> allWebsiteDataTypes];</span><br><span class="line">    <span class="built_in">NSDate</span> *dateFrom = [<span class="built_in">NSDate</span> dateWithTimeIntervalSince1970:<span class="number">0</span>];</span><br><span class="line">    [[<span class="built_in">WKWebsiteDataStore</span> defaultDataStore] removeDataOfTypes:websiteDataTypes modifiedSince:dateFrom completionHandler:^&#123;</span><br><span class="line">        <span class="comment">// Done</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"释放"</span>);</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>查找删除</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">WKWebsiteDataStore</span> *dataStore = [<span class="built_in">WKWebsiteDataStore</span> defaultDataStore];</span><br><span class="line">    [dataStore fetchDataRecordsOfTypes:[<span class="built_in">WKWebsiteDataStore</span> allWebsiteDataTypes] completionHandler:^(<span class="built_in">NSArray</span>&lt;<span class="built_in">WKWebsiteDataRecord</span> *&gt; * _Nonnull records) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">WKWebsiteDataRecord</span> *record <span class="keyword">in</span> records) &#123;</span><br><span class="line">            [dataStore removeDataOfTypes:record.dataTypes forDataRecords:@[record] completionHandler:^&#123;</span><br><span class="line">                <span class="comment">// done</span></span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>查找删除特定内容</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">WKWebsiteDataStore *dataStore = [WKWebsiteDataStore defaultDataStore];</span><br><span class="line">    [dataStore <span class="string">fetchDataRecordsOfTypes:</span>[WKWebsiteDataStore allWebsiteDataTypes] <span class="string">completionHandler:</span>^(NSArray&lt;WKWebsiteDataRecord *&gt; * _Nonnull records) &#123;</span><br><span class="line">        <span class="keyword">for</span> (WKWebsiteDataRecord *record <span class="keyword">in</span> records) &#123;</span><br><span class="line">            <span class="keyword">if</span> ([record.displayName <span class="string">isEqualToString:</span>@<span class="string">"baidu"</span>]) &#123;</span><br><span class="line">                [dataStore <span class="string">removeDataOfTypes:</span>record.dataTypes <span class="string">forDataRecords:</span>@[record] <span class="string">completionHandler:</span>^&#123;</span><br><span class="line">                    <span class="comment">// done</span></span><br><span class="line">                &#125;];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>
<p>新增cookie</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSHTTPCookie</span> *cookie = [<span class="built_in">NSHTTPCookie</span> cookieWithProperties:@&#123;</span><br><span class="line">                                                                <span class="built_in">NSHTTPCookieName</span>: <span class="string">@"xiaoda"</span>,</span><br><span class="line">                                                                <span class="built_in">NSHTTPCookieValue</span>: <span class="string">@"2018"</span>,</span><br><span class="line">                                                                <span class="built_in">NSHTTPCookieDomain</span>: <span class="string">@"baidu.com"</span>,</span><br><span class="line">                                                                <span class="built_in">NSHTTPCookiePath</span>: <span class="string">@"/"</span>,</span><br><span class="line">                                                                <span class="built_in">NSHTTPCookieExpires</span> :   [<span class="built_in">NSDate</span> dateWithTimeIntervalSinceNow:<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>]</span><br><span class="line">                                                                &#125;];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (@available(iOS <span class="number">11.0</span>, *)) &#123;</span><br><span class="line">        [web.webView.configuration.websiteDataStore.httpCookieStore setCookie:cookie completionHandler:^&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Fallback on earlier versions</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>获取cookie</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">if</span> (<span class="variable">@available</span>(iOS <span class="number">11.0</span>, *)) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="selector-attr">[webView.configuration.websiteDataStore.httpCookieStore getAllCookies:^(NSArray&lt;NSHTTPCookie *&gt; * _Nonnull cookies) &#123;</span></span><br><span class="line"><span class="selector-attr">            NSLog(@"%@", cookies);</span></span><br><span class="line"><span class="selector-attr">        &#125;]</span> ;</span><br><span class="line">        </span><br><span class="line">    &#125; <span class="selector-tag">else</span> &#123;</span><br><span class="line">        <span class="comment">// Fallback on earlier versions</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/WKWebView/">WKWebView</a></div><div class="post-nav"><a class="pre" href="/2018/09/24/[iOS] WKWebView遇到的那些坑/">WKWebView的那些坑</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/WKWebView/" style="font-size: 15px;">WKWebView</a> <a href="/tags/AFNetworking/" style="font-size: 15px;">AFNetworking</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://xiaochudaxia.com/" title="飞飞" target="_blank">飞飞</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">小大.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>